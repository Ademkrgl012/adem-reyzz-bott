const Discord = require("discord.js");
const fs = require("fs");
const client = new Discord.Client();
const http = require("http");
const db = require("quick.db");
const moment = require("moment");
const express = require("express");
const ayarlar = require("./ayarlar.json");
const app = express();
app.get("/", (request, response) => {
  response.sendStatus(200);
});
app.listen(process.env.PORT);
const log = message => {
  console.log(` ${message}`);
};
require("./util/eventLoader.js")(client);
client.on("ready", () => {
  console.log("Bot Ba≈üarƒ±lƒ± Bir ≈üekilde giri≈ü");
  client.user.setPresence({
    game: {
      // url: 'https://www.twitch.tv/amerikaniks'
      // Deƒüerler:
      // PLAYING: Oynuyor
      // WATCHING: ƒ∞zliyor
      // LISTENING: Dinliyor
      // STREAMING : Yayƒ±nda
    },
    status: "dnd"
    // Deƒüerler:
    // online: √áevrimi√ßi
    // dnd: Rahatsƒ±z Etmeyin
    // idle: Bo≈üta
  });
});

const bot = new Discord.Client();

var oyun = [
`‚ú® Yardƒ±m almak i√ßin | y!yardƒ±m`,
`üöÄ Yeni √ñzellikler ƒ∞√ßin | y!yardƒ±m`,
`üîî Abone Rol i√ßin | y!abone-sistemi`,
`üåü Kayƒ±t Sistemi i√ßin | y!kayƒ±t-yardƒ±m`,
`‚ö°Ô∏è Botu eklemek i√ßin | y!davet`
]
  
client.on("ready", () => {
setInterval(function() {

         var random = Math.floor(Math.random()*(oyun.length-0+1)+0);
         client.user.setActivity(oyun[random], {"type": "WATCHING"});

        }, 2 * 5000);
});

//-------------Bot Eklenince Bir Kanala Mesaj G√∂nderme Komutu ---------------\\

const emmmmbed = new Discord.MessageEmbed()
.setThumbnail()
.setImage("https://cdn.discordapp.com/attachments/797899158807117867/798281669961842806/standard_22.gif")
.addField(`Yrnex | Te≈üekk√ºrler`, `**Selamlar, Ben Yrnex (Yrnex Bot'un Geli≈ütiricisi) √ñncelikle Botumuzu Eklediƒüiniz ve Bize Destek Olduƒüunuz ƒ∞√ßin Sizlere Te≈üekk√ºrlerimi Sunarƒ±m**`)
.addField(`Yrnex | Prefix`, `**Yrnex Botun Prefixi(√∂n eki) = \`y!\`\n\n Deƒüi≈ütirebilmek i√ßin \`y!prefix\` Yazabilirsiniz.**`)
.addField(`Yrnex | Nasƒ±l Kullanƒ±lƒ±r?`, `**Yrnex botun t√ºm √∂zelliklerinden yararlanabilmek i√ßin sadece \`y!yardƒ±m\` yazmanƒ±z yeterlidir.**`)
.addField(`Yrnex | Linkler`, `**Sohbet Kanalƒ±na y!davet Yazmanƒ±z Yeterlidir**`)
.setFooter(`Yrnex | Geli≈ümi≈ü T√ºrk√ße Bot | 2021`)
.setTimestamp();


client.on("guildCreate", guild => {

let defaultChannel = "";
guild.channels.cache.forEach((channel) => {
if(channel.type == "text" && defaultChannel == "") {
if(channel.permissionsFor(guild.me).has("SEND_MESSAGES")) {
defaultChannel = channel;
}
}
})

defaultChannel.send(emmmmbed)

});

//----------------------------------------------------------------\\


client.commands = new Discord.Collection();
client.aliases = new Discord.Collection();
fs.readdir("./komutlar/", (err, files) => {
  if (err) console.error(err);
  log(`${files.length} komut y√ºklenecek.`);
  files.forEach(f => {
    let props = require(`./komutlar/${f}`);
    log(`Y√ºklenen komut: ${props.help.name}.`);
    client.commands.set(props.help.name, props);
    props.conf.aliases.forEach(alias => {
      client.aliases.set(alias, props.help.name);
    });
  });
});

client.reload = command => {
  return new Promise((resolve, reject) => {
    try {
      delete require.cache[require.resolve(`./komutlar/${command}`)];
      let cmd = require(`./komutlar/${command}`);
      client.commands.delete(command);
      client.aliases.forEach((cmd, alias) => {
        if (cmd === command) client.aliases.delete(alias);
      });
      client.commands.set(command, cmd);
      cmd.conf.aliases.forEach(alias => {
        client.aliases.set(alias, cmd.help.name);
      });
      resolve();
    } catch (e) {
      reject(e);
    }
  });
};

client.load = command => {
  return new Promise((resolve, reject) => {
    try {
      let cmd = require(`./komutlar/${command}`);
      client.commands.set(command, cmd);
      cmd.conf.aliases.forEach(alias => {
        client.aliases.set(alias, cmd.help.name);
      });
      resolve();
    } catch (e) {
      reject(e);
    }
  });
};

client.unload = command => {
  return new Promise((resolve, reject) => {
    try {
      delete require.cache[require.resolve(`./komutlar/${command}`)];
      let cmd = require(`./komutlar/${command}`);
      client.commands.delete(command);
      client.aliases.forEach((cmd, alias) => {
        if (cmd === command) client.aliases.delete(alias);
      });
      resolve();
    } catch (e) {
      reject(e);
    }
  });
};

client.elevation = message => {
  if (!message.guild) {
    return;
  }
  let permlvl = 0;
  if (message.member.hasPermission("BAN_MEMBERS")) permlvl = 2;
  if (message.member.hasPermission("ADMINISTRATOR")) permlvl = 3;
  if (message.author.id === ayarlar.sahip) permlvl = 4;
  return permlvl;
};

client.on("guildMemberRemove", async member => {
  const channel = db.fetch(`saya√ßKanal_${member.guild.id}`);
  if (db.has(`sayacsayƒ±_${member.guild.id}`) == false) return;
  if (db.has(`saya√ßKanal_${member.guild.id}`) == false) return;

  member.guild.channels.cache
    .get(channel)
    .send(
      `üì§ **${member.user.tag}** Sunucudan ayrƒ±ldƒ±! \`${db.fetch(
        `sayacsayƒ±_${member.guild.id}`
      )}\` √ºye olmamƒ±za son \`${db.fetch(`sayacsayƒ±_${member.guild.id}`) -
        member.guild.memberCount}\` √ºye kaldƒ±!`
    );
});
client.on("guildMemberAdd", async member => {
  const channel = db.fetch(`saya√ßKanal_${member.guild.id}`);
  if (db.has(`sayacsayƒ±_${member.guild.id}`) == false) return;
  if (db.has(`saya√ßKanal_${member.guild.id}`) == false) return;

  member.guild.channels.cache
    .get(channel)
    .send(
      `üì• **${member.user.tag}** Sunucuya Katƒ±ldƒ±! \`${db.fetch(
        `sayacsayƒ±_${member.guild.id}`
      )}\` √ºye olmamƒ±za son \`${db.fetch(`sayacsayƒ±_${member.guild.id}`) -
        member.guild.memberCount}\` √ºye kaldƒ±!`
    );
});

///////////////////////////////////SA-AS

client.on("message", async msg => {
  const i = await db.fetch(`ssaass_${msg.guild.id}`);
  if (i == "acik") {
    if (
      msg.content.toLowerCase() == "sa" ||
      msg.content.toLowerCase() == "s.a" ||
      msg.content.toLowerCase() == "selamun aleyk√ºm" ||
      msg.content.toLowerCase() == "sea" ||
      msg.content.toLowerCase() == "selam"
    ) {
      try {
        return msg.reply(
          "**Aleyk√ºm Selam Ho≈ügeldin** <:tatli:794115253436809236>"
        );
      } catch (err) {
        console.log(err);
      }
    }
  } else if (i == "kapali") {
  }
  if (!i) return;
});

//////////////afk

const { DiscordAPIError } = require("discord.js");

client.on("message", async message => {
  if (message.author.bot) return;
  if (!message.guild) return;
  if (message.content.includes(`afk`)) return;

  if (await db.fetch(`afk_${message.author.id}`)) {
    db.delete(`afk_${message.author.id}`);
    db.delete(`afk_s√ºre_${message.author.id}`);

    const embed = new Discord.MessageEmbed()

      .setColor("GREEN")
      .setAuthor(message.author.username, message.author.avatarURL)
      .setDescription(`${message.author.username} Artƒ±k \`AFK\` Deƒüilsin.`);

    message.channel.send(embed);
  }

  var USER = message.mentions.users.first();
  if (!USER) return;
  var REASON = await db.fetch(`afk_${USER.id}`);

  if (REASON) {
    let s√ºre = await db.fetch(`afk_s√ºre_${USER.id}`);

    const afk = new Discord.MessageEmbed()

      .setColor("GOLD")
      .setDescription(
        `**BU KULLANICI AFK**\n\n**Afk Olan Kullanƒ±cƒ± :** \`${USER.tag}\`\n\n**Sebep :** \`${REASON}\``
      );

    message.channel.send(afk);
  }
});

/////////////////////////////////

client.on("guildDelete", guild => {
  let Crewembed = new Discord.MessageEmbed()

    .setColor("RED")
    .setTitle(" ATILDIM !")
    .addField("Sunucu Adƒ±:", guild.name)
    .addField("Sunucu sahibi", guild.owner)
    .addField("Sunucudaki Ki≈üi Sayƒ±sƒ±:", guild.memberCount);

  client.channels.cache.get("798573177348423720").send(Crewembed);
});

client.on("guildCreate", guild => {
  let Crewembed = new Discord.MessageEmbed()

    .setColor("GREEN")
    .setTitle("EKLENDƒ∞M !")
    .addField("Sunucu Adƒ±:", guild.name)
    .addField("Sunucu sahibi", guild.owner)
    .addField("Sunucudaki Ki≈üi Sayƒ±sƒ±:", guild.memberCount);

  client.channels.cache.get("798573177348423720").send(Crewembed);
});

///////////////////////////////////REKLAMENLGEL

client.on("message", msg => {
  if (!db.has(`reklam_${msg.guild.id}`)) return;
  const reklam = [
    ".com",
    ".net",
    ".xyz",
    ".tk",
    ".pw",
    ".io",
    ".me",
    ".gg",
    "www.",
    "https",
    "http",
    ".gl",
    ".org",
    ".com.tr",
    ".biz",
    "net",
    ".rf.gd",
    ".az",
    ".party",
    "discord.gg"
  ];
  if (reklam.some(word => msg.content.includes(word))) {
    try {
      if (!msg.member.hasPermission("BAN_MEMBERS")) {
        msg.delete();
        return msg
          .reply(
            "**Bu Sunucuda** `Reklam Engelle`** Aktif Reklam Yapmana ƒ∞zin Vermem !**"
          )
          .then(msg => msg.delete(4000));

        msg.delete(4000);
      }
    } catch (err) {
      console.log(err);
    }
  }
});

////////////////////K√úF√úR

client.on("message", async msg => {
  if (msg.author.bot) return;
  if (msg.channel.type === "dm") return;

  let i = await db.fetch(`k√ºf√ºrFiltre_${msg.guild.id}`);
  if (i == "acik") {
    const k√ºf√ºr = [
      "amcƒ±k",
      "yarrak",
      "orospu",
      "pi√ß",
      "sikerim",
      "sikik",
      "amƒ±na",
      "pezevenk",
      "yav≈üak",
      "ananƒ±",
      "anandƒ±r",
      "orospu",
      "evladƒ±",
      "g√∂t",
      "pipi",
      "sokuk",
      "yarak",
      "bacƒ±nƒ±",
      "karƒ±nƒ±",
      "amk",
      "aq",
      "mk",
      "anaskm"
    ];
    if (k√ºf√ºr.some(word => msg.content.toLowerCase().includes(word))) {
      try {
        if (!msg.member.hasPermission("MANAGE_WEBHOOKS")) {
          msg.delete();
          let embed = new Discord.MessageEmbed()
            .setColor(0xffa300)
            .setFooter("Yrnex K√ºf√ºr Sistemi", client.user.avatarURL())
            .setAuthor(
              msg.guild.owner.user.username,
              msg.guild.owner.user.avatarURL()
            )
            .setDescription(
              "Yrnex, " +
                `***${msg.guild.name}***` +
                " adlƒ± sunucunuzda k√ºf√ºr yakaladƒ±m."
            )
            .addField(
              "K√ºf√ºr Eden Ki≈üi",
              "Kullanƒ±cƒ±: " + msg.author.tag + "\nID: " + msg.author.id,
              true
            )
            .addField("Engellenen mesaj", msg.content, true)
            .setTimestamp();
          msg.guild.owner.user.send(embed);
          return msg.channel
            .send(
              `${msg.author}, K√ºf√ºr Etmek Yasak! Senin Mesajƒ±nƒ± √ñzelden Kurucumuza G√∂nderdim.`
            )
            .then(msg => msg.delete(25000));
        }
      } catch (err) {
        console.log(err);
      }
    }
  }
  if (!i) return;
});

//////////////////////////MODLOG///////////////////
client.on("messageDelete", async message => {
  if (message.author.bot || message.channel.type == "dm") return;

  let log = message.guild.channels.cache.get(
    await db.fetch(`log_${message.guild.id}`)
  );

  if (!log) return;

  const embed = new Discord.MessageEmbed()

    .setTitle(message.author.username + " | Mesaj Silindi")

    .addField("Kullanƒ±cƒ±: ", message.author)

    .addField("Kanal: ", message.channel)

    .addField("Mesaj: ", "" + message.content + "");

  log.send(embed);
});

client.on("messageUpdate", async (oldMessage, newMessage) => {
  let modlog = await db.fetch(`log_${oldMessage.guild.id}`);

  if (!modlog) return;

  let embed = new Discord.MessageEmbed()

    .setAuthor(oldMessage.author.username, oldMessage.author.avatarURL())

    .addField("**Eylem**", "Mesaj D√ºzenleme")

    .addField("**Mesajƒ±n sahibi**",`<@${oldMessage.author.id}> === **${oldMessage.author.id}**`)

    .addField("**Eski Mesajƒ±**", `${oldMessage.content}`)

    .addField("**Yeni Mesajƒ±**", `${newMessage.content}`)

    .setTimestamp()

    .setColor("RANDOM")

    .setFooter(
      `Sunucu: ${oldMessage.guild.name} - ${oldMessage.guild.id}`,
      oldMessage.guild.iconURL()
    )

    .setThumbnail(oldMessage.guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("channelCreate", async channel => {
  let modlog = await db.fetch(`log_${channel.guild.id}`);

  if (!modlog) return;

  const entry = await channel.guild
    .fetchAuditLogs({ type: "CHANNEL_CREATE" })
    .then(audit => audit.entries.first());

  let kanal;

  if (channel.type === "text") kanal = `<#${channel.id}>`;

  if (channel.type === "voice") kanal = `\`${channel.name}\``;

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Kanal Olu≈üturma")

    .addField("**Kanalƒ± Olu≈üturan Ki≈üi**", `<@${entry.executor.id}>`)

    .addField("**Olu≈üturduƒüu Kanal**", `${kanal}`)

    .setTimestamp()

    .setColor("RANDOM")

    .setFooter(
      `Sunucu: ${channel.guild.name} - ${channel.guild.id}`,
      channel.guild.iconURL()
    )

    .setThumbnail(channel.guild.iconUR);

  client.channels.cache.get(modlog).send(embed);
});

client.on("channelDelete", async channel => {
  let modlog = await db.fetch(`log_${channel.guild.id}`);

  if (!modlog) return;

  const entry = await channel.guild
    .fetchAuditLogs({ type: "CHANNEL_DELETE" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Kanal Silme")

    .addField("**Kanalƒ± Silen Ki≈üi**", `<@${entry.executor.id}>`)

    .addField("**Silinen Kanal**", `\`${channel.name}\``)

    .setTimestamp()

    .setColor("RANDOM")

    .setFooter(
      `Sunucu: ${channel.guild.name} - ${channel.guild.id}`,
      channel.guild.iconURL()
    )

    .setThumbnail(channel.guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("roleCreate", async role => {
  let modlog = await db.fetch(`log_${role.guild.id}`);

  if (!modlog) return;

  const entry = await role.guild
    .fetchAuditLogs({ type: "ROLE_CREATE" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Rol Olu≈üturma")

    .addField("**Rol√º olu≈üturan ki≈üi**", `<@${entry.executor.id}>`)

    .addField("**Olu≈üturulan rol**", `\`${role.name}\` **=** \`${role.id}\``)

    .setTimestamp()

    .setFooter(
      `Sunucu: ${role.guild.name} - ${role.guild.id}`,
      role.guild.iconURL
    )

    .setColor("RANDOM")

    .setThumbnail(role.guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("roleDelete", async role => {
  let modlog = await db.fetch(`log_${role.guild.id}`);

  if (!modlog) return;

  const entry = await role.guild
    .fetchAuditLogs({ type: "ROLE_DELETE" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Rol Silme")

    .addField("**Rol√º silen ki≈üi**", `<@${entry.executor.id}>`)

    .addField("**Silinen rol**", `\`${role.name}\` **=** \`${role.id}\``)

    .setTimestamp()

    .setFooter(
      `Sunucu: ${role.guild.name} - ${role.guild.id}`,
      role.guild.iconURL
    )

    .setColor("RANDOM")

    .setThumbnail(role.guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("emojiCreate", async emoji => {
  let modlog = await db.fetch(`log_${emoji.guild.id}`);

  if (!modlog) return;

  const entry = await emoji.guild
    .fetchAuditLogs({ type: "EMOJI_CREATE" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Emoji Olu≈üturma")

    .addField("**Emojiyi olu≈üturan ki≈üi**", `<@${entry.executor.id}>`)

    .addField("**Olu≈üturulan emoji**", `${emoji} - ƒ∞smi: \`${emoji.name}\``)

    .setTimestamp()

    .setColor("RANDOM")

    .setFooter(
      `Sunucu: ${emoji.guild.name} - ${emoji.guild.id}`,
      emoji.guild.iconURL
    )

    .setThumbnail(emoji.guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("emojiDelete", async emoji => {
  let modlog = await db.fetch(`log_${emoji.guild.id}`);

  if (!modlog) return;

  const entry = await emoji.guild
    .fetchAuditLogs({ type: "EMOJI_DELETE" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Emoji Silme")

    .addField("**Emojiyi silen ki≈üi**", `<@${entry.executor.id}>`)

    .addField("**Silinen emoji**", `${emoji}`)

    .setTimestamp()

    .setFooter(
      `Sunucu: ${emoji.guild.name} - ${emoji.guild.id}`,
      emoji.guild.iconURL
    )

    .setColor("RANDOM")

    .setThumbnail(emoji.guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("emojiUpdate", async (oldEmoji, newEmoji) => {
  let modlog = await db.fetch(`log_${oldEmoji.guild.id}`);

  if (!modlog) return;

  const entry = await oldEmoji.guild
    .fetchAuditLogs({ type: "EMOJI_UPDATE" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Emoji G√ºncelleme")

    .addField("**Emojiyi g√ºncelleyen ki≈üi**", `<@${entry.executor.id}>`)

    .addField(
      "**G√ºncellenmeden √∂nceki emoji**",
      `${oldEmoji} - ƒ∞smi: \`${oldEmoji.name}\``
    )

    .addField(
      "**G√ºncellendikten sonraki emoji**",
      `${newEmoji} - ƒ∞smi: \`${newEmoji.name}\``
    )

    .setTimestamp()

    .setColor("RANDOM")

    .setFooter(
      `Sunucu: ${oldEmoji.guild.name} - ${oldEmoji.guild.id}`,
      oldEmoji.guild.iconURL
    )

    .setThumbnail(oldEmoji.guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("guildBanAdd", async (guild, user) => {
  let modlog = await db.fetch(`log_${guild.id}`);

  if (!modlog) return;

  const entry = await guild
    .fetchAuditLogs({ type: "MEMBER_BAN_ADD" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Yasaklama")

    .addField("**Kullanƒ±cƒ±yƒ± yasaklayan yetkili**", `<@${entry.executor.id}>`)

    .addField("**Yasaklanan kullanƒ±cƒ±**", `**${user.tag}** - ${user.id}`)

    .addField("**Yasaklanma sebebi**", `${entry.reason}`)

    .setTimestamp()

    .setColor("RANDOM")

    .setFooter(`Sunucu: ${guild.name} - ${guild.id}`, guild.iconURL)

    .setThumbnail(guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

client.on("guildBanRemove", async (guild, user) => {
  let modlog = await db.fetch(`log_${guild.id}`);

  if (!modlog) return;

  const entry = await guild
    .fetchAuditLogs({ type: "MEMBER_BAN_REMOVE" })
    .then(audit => audit.entries.first());

  let embed = new Discord.MessageEmbed()

    .setAuthor(entry.executor.username, entry.executor.avatarURL())

    .addField("**Eylem**", "Yasak kaldƒ±rma")

    .addField("**Yasaƒüƒ± kaldƒ±ran yetkili**", `<@${entry.executor.id}>`)

    .addField("**Yasaƒüƒ± kaldƒ±rƒ±lan kullanƒ±cƒ±**", `**${user.tag}** - ${user.id}`)

    .setTimestamp()

    .setColor("RANDOM")

    .setFooter(`Sunucu: ${guild.name} - ${guild.id}`, guild.iconURL)

    .setThumbnail(guild.iconURL);

  client.channels.cache.get(modlog).send(embed);
});

//////////////////////////////MODLOG///////////////////////////

client.on("message", message => {
  if (message.channel.id !== "797822239126192148") return;

  message.react("<:yr_evet:793837194175447090>");
  message.react("<:yr_hayr:793837203478020127>");
});

//////////////////////////////OTOROL

client.on("guildMemberAdd", member => {
  let rol = db.fetch(`autoRole_${member.guild.id}`);
  if (!rol) return;
  let kanal = db.fetch(`autoRoleChannel_${member.guild.id}`);
  if (!kanal) return;

  member.roles.add(member.guild.roles.cache.get(rol));
  let embed = new Discord.MessageEmbed()
    .setDescription(
      "> <a:yrnex_hypes:794222389584068618> **Sunucuya yeni katƒ±lan** **" +
        member.user.username +
        "** **Kullanƒ±cƒ±sƒ±na** <@&" +
        rol +
        "> **Rol√º verildi** <a:yrnex_tiks:798275047047168041>"
    )
    .setColor("RANDOM"); //.setFooter(`<@member.id>`)
  member.guild.channels.cache.get(kanal).send(embed);
});

client.on("ready", async () => {
  let botVoiceChannel = client.channels.cache.get("780344877576749087");
  console.log("Bot Ses Kanalƒ±na baƒülandƒ±!");
  if (botVoiceChannel)
    botVoiceChannel
      .join()
      .catch(err => console.error("Bot ses kanalƒ±na baƒülanamadƒ±!"));
});

///////////////////////////////

client.on("guildMemberAdd", member => {
  let botrol√º = "787328444954050570";
  let kayƒ±tsƒ±zrol√º = "";
  if (member.user.bot) {
    member.roles.add(botrol√º);
  } else {
    member.roles.add(kayƒ±tsƒ±zrol√º);
  }
});

//---------------------------------|G√ºvenlik Sistemi Ba≈ülangƒ±√ß|---------------------------------\\
client.on("guildMemberAdd", member => {
  let kanal = db.fetch(`g√ºvenlik.${member.guild.id}`);
  if (!kanal) return;

  let aylar = {
    "01": "Ocak",
    "02": "≈ûubat",
    "03": "Mart",
    "04": "Nisan",
    "05": "Mayƒ±s",
    "06": "Haziran",
    "07": "Temmuz",
    "08": "Aƒüustos",
    "09": "Eyl√ºl",
    "10": "Ekim",
    "11": "Kasƒ±m",
    "12": "Aralƒ±k"
  };

  let biti≈ü = member.user.createdAt;
  let g√ºn√º = moment(new Date(biti≈ü).toISOString()).format("DD");
  let ayƒ± = moment(new Date(biti≈ü).toISOString())
    .format("MM")
    .replace("01", "Ocak")
    .replace("02", "≈ûubat")
    .replace("03", "Mart")
    .replace("04", "Nisan")
    .replace("05", "Mayƒ±s")
    .replace("06", "Haziran")
    .replace("07", "Temmuz")
    .replace("08", "Aƒüustos")
    .replace("09", "Eyl√ºl")
    .replace("10", "Ekim")
    .replace("11", "Kasƒ±m")
    .replace("12", "Aralƒ±k")
    .replace("13", "CodAre"); //codare
  let yƒ±lƒ± = moment(new Date(biti≈ü).toISOString()).format("YYYY");
  let saati = moment(new Date(biti≈ü).toISOString()).format("HH:mm");

  let g√ºnay = `${g√ºn√º} ${ayƒ±} ${yƒ±lƒ±} ${saati}`;

  let s√ºre = member.user.createdAt;
  let g√ºn = moment(new Date(s√ºre).toISOString()).format("DD");
  let hafta = moment(new Date(s√ºre).toISOString()).format("WW");
  let ay = moment(new Date(s√ºre).toISOString()).format("MM");
  let ayy = moment(new Date(s√ºre).toISOString()).format("MM");
  let yƒ±l = moment(new Date(s√ºre).toISOString()).format("YYYY");
  let yƒ±l2 = moment(new Date().toISOString()).format("YYYY");

  let netyƒ±l = yƒ±l2 - yƒ±l;

  let created = ` ${netyƒ±l} yƒ±l  ${ay} ay ${hafta} hafta ${g√ºn} g√ºn √∂nce`;

  let kontrol;
  if (s√ºre < 1296000000)
    kontrol = "<a:yr_uyar:775360587650564127> Bu hesap ≈ü√ºpheli!";
  if (s√ºre > 1296000000)
    kontrol = "<a:yrnex_tiks:798275047047168041> Bu hesap g√ºvenli!";

  let codare = new Discord.MessageEmbed()
    .setColor("BALACK")
    .setTitle(`${member.user.username} Sunucuya Katƒ±ldƒ±`)
    .setDescription(
      "<@" +
        member.id +
        "> Bilgileri : \n  Hesap olu≈üturulma tarihi (`" +
        g√ºnay +
        "`) \n Hesap durumu : **" +
        kontrol +
        "**"
    ) //codare
    .setTimestamp();
  client.channels.cache.get(kanal).send(codare);
});
//---------------------------------|G√ºvenlik Sistemi Son|---------------------------------\\

client.login(ayarlar.token);
